/*
 * video.c
 *
 *  Created on: 26 апр. 2018 г.
 *      Author: user
 */

#include "../include/video.h"

void setcolor(uint8_t r, uint8_t g, uint8_t b) {
	red = r;
	green = g;
	blue = b;
}
void drawpixel(uint16_t x, uint16_t y) {

	vid[(y * 1024 + x) * 4 + 1] = red;
	vid[(y * 1024 + x) * 4 + 0] = blue + green * 256;
}

void drawline(uint16_t x1, uint16_t y1, uint16_t x2, uint16_t y2) {
	uint16_t steps;
	int cc;
	if (abs(x2 - x1) > abs(y2 - y1))
		steps = abs(x2 - x1);
	else
		steps = abs(y2 - y1);

	for (cc = 0; cc <= steps; cc++) {
		drawpixel(x1 + floor(1.0 * (x2 - x1) / steps * cc),
				y1 + floor(1.0 * (y2 - y1) / steps * cc));
	}

}

double hue2rgb(double p, double q, double tt) {
	double t;
	t = tt;
	if (t < 0)
		t += 1;
	if (t > 1)
		t -= 1;

	if (t < 1.0 / 6.0)
		return p + (q - p) * 6 * t;
	else if (t < 1.0 / 2.0)
		return q;
	else if (t < 2.0 / 3.0)
		return p + (q - p) * (2.0 / 3.0 - t) * 6;
	else
		return p;
}

uint8_t hslToR(double h, double s, double l) {

	if (s == 0) {
		return l;
	} else {

		double q = (l < 0.5) ? (l * (1 + s)) : (l + s - l * s);
		double p = 2 * l - q;
		return floor(255.0 * hue2rgb(p, q, h + 1.0 / 3.0));

	}
}
///

uint8_t hslToG(double h, double s, double l) {

	if (s == 0) {
		return l;
	} else {

		double q = (l < 0.5) ? (l * (1 + s)) : (l + s - l * s);
		double p = 2 * l - q;

		return floor(255.0 * hue2rgb(p, q, h));

	}
}
///
uint8_t hslToB(double h, double s, double l) {

	if (s == 0) {
		return l;
	} else {

		double q = (l < 0.5) ? (l * (1 + s)) : (l + s - l * s);
		double p = 2 * l - q;

		return floor(255.0 * hue2rgb(p, q, h - 1.0 / 3.0));
	}
}


void drawtext(const char * string, int size, uint16_t x, uint16_t y) {
	int counter;
	int i;
	int j;

	for (counter = 0; counter < size; counter++) {
		for (i = 0; i < 8; i++) {
			for (j = 0; j < 8; j++) {
				if (font[string[counter]][j * 8 + i] == 0)
					drawpixel(x + counter * 8 + i, y + j);
			}
		}
	}
}

void clrscr() {

//	memset(vid,0,1024*768*4*sizeof(uint16_t));
	memcpy(vid, splash, 1024 * 768 * 4 * sizeof(uint16_t));

}
